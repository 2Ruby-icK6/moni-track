{% extends 'layouts/base.html' %}

{% block title %} Tables {% endblock title %}

{% block content %}

<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <div class="card mb-4">
        <div class="card-header pb-0">
          <div class="d-flex justify-content-between">
            <h6>Infrastructure Table</h6>

            <div class="d-flex gap-3">

              <a href="{% url 'project_flextable' %}" class="btn btn-sm bg-gradient-success d-flex gap-1 align-items-center justify-content-center">
                <i class="ni ni-settings-gear-65 me-sm-1"></i>
                <span class="d-sm-inline d-none">Flex Table</span>
              </a>
  
              <!-- Filter Dropdown -->
              <div class="dropdown">
                <button class="btn btn-sm bg-gradient-success dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  Filters
                </button>
                <div class="dropdown-menu p-3" id="filterDropdown" style="max-height: 300px; overflow-y: auto; width: 250px;">
                  <form method="GET" id="filterForm">
                    <input type="hidden" name="page" value="{{ request.GET.page }}">

                    <div class="mb-2">
                      <label for="categoryFilter">Category</label>
                      <select class="form-control" name="category" id="categoryFilter">
                        <option value="">All</option>
                        {% for category in category %}
                          <option value="{{ category }}" {% if request.GET.category == category %}selected{% endif %}>{{ category }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <div class="mb-2">
                      <label for="subcategoryFilter">Sub Category</label>
                      <select class="form-control" name="sub_category" id="subcategoryFilter">
                        <option value="">All</option>
                        {% for sub_category in sub_category %}
                          <option value="{{ sub_category }}" {% if request.GET.sub_category == sub_category %}selected{% endif %}>{{ sub_category }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <div class="mb-2">
                      <label class="form-label" for="municipalityFilter">Municipality</label>
                      <select class="form-control" name="municipality" id="municipalityFilter">
                        <option value="">All</option>
                        {% for municipality in municipality %}
                          <option value="{{ municipality }}" {% if request.GET.municipality == municipality %}selected{% endif %}>{{ municipality }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <!-- Year Range Filter -->
                    <div class="mb-2 d-flex gap-2 align-items-center">
                      <div class="w-50">
                        <label for="startYearFilter">Start Year</label>
                        <input type="number" class="form-control" name="start_year" id="startYearFilter" 
                              value="{{ request.GET.start_year }}" placeholder="YYYY">
                      </div>
                      <div class="w-50">
                        <label for="endYearFilter">End Year</label>
                        <input type="number" class="form-control" name="end_year" id="endYearFilter" 
                              value="{{ request.GET.end_year }}" placeholder="YYYY">
                      </div>
                    </div>

                    <div class="mb-2">
                      <label for="fundFilter">Funding Source</label>
                      <select class="form-control" name="fund" id="fundFilter">
                        <option value="">All</option>
                        {% for fund in fund %}
                          <option value="{{ fund }}" {% if request.GET.fund == fund %}selected{% endif %}>{{ fund }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <div class="mb-2">
                      <label for="remarksFilter">Remarks</label>
                      <select class="form-control" name="remarks" id="remarksFilter">
                        <option value="">All</option>
                        {% for remark in remark %}
                          <option value="{{ remark }}" {% if request.GET.remarks == remark %}selected{% endif %}>{{ remark }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <button type="submit" class="btn btn-success w-100 mt-2">Apply Filters</button>
                    <a href="{% url 'project_table' %}" class="btn btn-secondary w-100 mt-2">Reset</a>
                  </form>
                </div>
              </div>
  
              <a href="/update-infra.html" class="btn btn-sm bg-gradient-success d-flex gap-1 align-items-center justify-content-center">
                <i class="ni ni-settings me-sm-1"></i>
                <span class="d-sm-inline d-none">Update Data</span>
              </a>

            </div>

          </div>          
        </div>
        <div class="card-body px-0 pt-0 pb-2">
          <div class="table-responsive p-0">
            <table class="table align-items-center table-bordered table-hover mb-0">
              <thead>
                <tr>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">NO</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Project Name</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Project ID</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Project Description</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Location</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Municipality</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Office</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Year</th>
                </tr>
              </thead>
              <tbody>
                {% for project in projects %}
                <tr>
                  <td class="text-center align-middle">
                    <h6 class="text-sm">{{ project.project_number }}</h6>
                  </td>
                  <td>
                    <h6 class="text-wrap text-sm">{{ project.project_name }}</h6>
                    <p class="text-xs text-secondary mb-0">{{ project.category.category }} - {{ project.sub_category.sub_category }}</p>
                  </td>
                  <td>
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.project_ID }}</p>
                  </td>
                  <td>
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.project_description }}</p>
                  </td>
                  <td>
                    <p class="text-secondary text-xs font-weight-bold mb-0">{{ project.location }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-secondary text-xs font-weight-bold mb-0">{{ project.municipality.municipality }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-xs font-weight-bold mb-0">{{ project.office.office }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-xs font-weight-bold mb-0">{{ project.year.year }}</p>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <div class="card mb-4">
        <div class="card-header pb-0">
          <h6>Contract Table</h6>
        </div>
        <div class="card-body px-0 pt-0 pb-2">
          <div class="table-responsive p-0">
            <table class="table align-items-center table-bordered table-hover mb-0">
              <thead>
                <tr>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">NO</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Project Cost</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Contract Cost</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Mode of Procurement</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Quarterly Report</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Project Contractor</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">General Remarks</th>
                </tr>
              </thead>
              <tbody>
                {% for project in projects %}
                <tr>
                  <td class="text-center align-middle">
                    <h6 class="text-sm">{{ project.project_number }}</h6>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.contract.project_cost }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.contract.contract_cost }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.contract.procurement }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-secondary text-xs font-weight-bold mb-0">{{ project.contract.quarter }}</p>
                  </td>
                  <td>
                    <p class="text-wrap text-xs font-weight-bold mb-0"">{{ project.contract.contractor }}</p>
                    <p class="text-xs text-secondary mb-0">{{ project.contract.contractor.tin_number }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-xs font-weight-bold mb-0">{{ project.contract.remarks }}</p>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <div class="card mb-4">
        <div class="card-header pb-0">
          <h6>Project Timeline Table</h6>
        </div>
        <div class="card-body px-0 pt-0 pb-2">
          <div class="table-responsive p-0">
            <table class="table align-items-center table-bordered table-hover mb-0">
              <thead>
                <tr>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">NO</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">C D</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">NTP Date</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Target Completion Date</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Revised Completion Date</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Date Completed</th>
                </tr>
              </thead>
              <tbody>
                {% for project in projects %}
                <tr>
                  <td class="text-center align-middle">
                    <h6 class="text-sm">{{ project.project_number }}</h6>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.timeline.cd }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.timeline.ntp_date }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-wrap text-xs font-weight-bold mb-0">{{ project.timeline.target_completion_date }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-secondary text-xs font-weight-bold mb-0">{{ project.timeline.revised_completion_date }}</p>
                  </td>
                  <td class="text-center align-middle">
                    <p class="text-secondary text-xs font-weight-bold mb-0">{{ project.timeline.date_completed }}</p>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="fixed-plugin">
  <a class="fixed-plugin-button text-dark position-fixed px-3 py-2">
    <i class="fa fa-cog py-2"> </i>
  </a>
  <div class="card shadow-lg">
    <div class="card-header pb-0 pt-3 ">
      <div class="float-start">
        <h5 class="mt-3 mb-0">Argon Configurator</h5>
        <p>See our dashboard options.</p>
      </div>
      <div class="float-end mt-4">
        <button class="btn btn-link text-dark p-0 fixed-plugin-close-button">
          <i class="fa fa-close"></i>
        </button>
      </div>
      <!-- End Toggle Button -->
    </div>
    <hr class="horizontal dark my-1">
    <div class="card-body pt-sm-3 pt-0 overflow-auto">
      <!-- Sidebar Backgrounds -->
      <div>
        <h6 class="mb-0">Sidebar Colors</h6>
      </div>
      <a href="javascript:void(0)" class="switch-trigger background-color">
        <div class="badge-colors my-2 text-start">
          <span class="badge filter bg-gradient-primary active" data-color="primary" onclick="sidebarColor(this)"></span>
          <span class="badge filter bg-gradient-dark" data-color="dark" onclick="sidebarColor(this)"></span>
          <span class="badge filter bg-gradient-info" data-color="info" onclick="sidebarColor(this)"></span>
          <span class="badge filter bg-gradient-success" data-color="success" onclick="sidebarColor(this)"></span>
          <span class="badge filter bg-gradient-warning" data-color="warning" onclick="sidebarColor(this)"></span>
          <span class="badge filter bg-gradient-danger" data-color="danger" onclick="sidebarColor(this)"></span>
        </div>
      </a>
      <!-- Sidenav Type -->
      <div class="mt-3">
        <h6 class="mb-0">Sidenav Type</h6>
        <p class="text-sm">Choose between 2 different sidenav types.</p>
      </div>
      <div class="d-flex">
        <button class="btn bg-gradient-primary w-100 px-3 mb-2 active me-2" data-class="bg-white" onclick="sidebarType(this)">White</button>
        <button class="btn bg-gradient-primary w-100 px-3 mb-2" data-class="bg-default" onclick="sidebarType(this)">Dark</button>
      </div>
      <p class="text-sm d-xl-none d-block mt-2">You can change the sidenav type just on desktop view.</p>
      <!-- Navbar Fixed -->
      <div class="d-flex my-3">
        <h6 class="mb-0">Navbar Fixed</h6>
        <div class="form-check form-switch ps-0 ms-auto my-auto">
          <input class="form-check-input mt-1 ms-auto" type="checkbox" id="navbarFixed" onclick="navbarFixed(this)">
        </div>
      </div>
      <hr class="horizontal dark my-sm-4">
      <div class="mt-2 mb-5 d-flex">
        <h6 class="mb-0">Light / Dark</h6>
        <div class="form-check form-switch ps-0 ms-auto my-auto">
          <input class="form-check-input mt-1 ms-auto" type="checkbox" id="dark-version" onclick="darkMode(this)">
        </div>
      </div>
      <a class="btn bg-gradient-dark w-100" href="https://www.creative-tim.com/product/argon-dashboard">Free Download</a>
      <a class="btn btn-outline-dark w-100" href="https://www.creative-tim.com/learning-lab/bootstrap/license/argon-dashboard">View documentation</a>
      <div class="w-100 text-center">
        <a class="github-button" href="https://github.com/creativetimofficial/argon-dashboard" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star creativetimofficial/argon-dashboard on GitHub">Star</a>
        <h6 class="mt-3">Thank you for sharing!</h6>
        <a href="https://twitter.com/intent/tweet?text=Check%20Argon%20Dashboard%20made%20by%20%40CreativeTim%20%23webdesign%20%23dashboard%20%23bootstrap5&amp;url=https%3A%2F%2Fwww.creative-tim.com%2Fproduct%2Fargon-dashboard" class="btn btn-dark mb-0 me-2" target="_blank">
          <i class="fab fa-twitter me-1" aria-hidden="true"></i> Tweet
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.creative-tim.com/product/argon-dashboard" class="btn btn-dark mb-0 me-2" target="_blank">
          <i class="fab fa-facebook-square me-1" aria-hidden="true"></i> Share
        </a>
      </div>
    </div>
  </div>
</div>

  </div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}{% endblock javascripts %}
